ST:ST48,ST46,ST44,ST42,ST41,ST45,ST47,ST43
NH:NH61,NH60,NH64,NH65,NH67,NH69,NH61,NH68
SM:SM112,SM116,SM117,SM118,SM115,SM111,SM113,SM114
EG:EG25,EG26,EG21,EG27,EG24,EG22,EG28,EG23
AR:AR62,AR67,AR65,AR61,AR63,AR68,AR66,AR64
TV:TV70,TV67,TV66,TV65,TV69,TV74,TV73,TV68
GF:GF03,GF38,GF04,GF01,GF02,GF23,GF49,GF05,GF07,GF28
ARD:ARD20,ARD23,ARD8,ARD21,ARD6,ARD18,ARD15

# PREPARE INPUT for chr > 1 Mbp for each population
for chr in tig00000004 tig00000025 tig00023313 tig00000069 tig00000092 tig00000104 tig00000123 tig00000112 tig00023367 tig00023308 tig00000175 tig00023325 tig00000191 tig00000156 tig00023380 tig00000166 tig00000178 tig00000165 tig00023422 tig00023431 tig00000185 tig00000224 tig00023309 tig00000280 tig00000243 tig00000334 tig00000406 tig00023455 tig00023334 tig00023437 tig00000348 tig00023543 tig00023450 tig00023331 tig00023368 tig00000410 tig00000430 tig00000479 tig00023498 tig00023302 tig00000575 tig00000555 tig00000579 tig00000590 tig00023461 tig00000532 tig00000570 tig00023535 tig00000691 tig00023572 tig00000659 tig00000714 tig00000604 tig00000609 tig00000683 tig00000626 tig00000759 tig00000647 tig00000787 tig00000906 tig00000693 tig00023349 tig00023328 tig00023419 tig00000819
do
	smc++ vcf2smc freebayes.SNPs.filtered.final.recode.vcf.gz out/BOTH$chr.smc.gz $chr South:GF03,GF38,GF04,GF01,GF02,GF23,GF49,GF05,GF07,GF28,AR62,AR67,AR65,AR61,AR63,AR68,AR66,AR64,TV70,TV67,TV66,TV65,TV69,TV74,TV73,TV68,EG25,EG26,EG21,EG27,EG24,EG22,EG28,EG23 West:ST48,ST46,ST44,ST42,ST41,ST45,ST47,ST43,NH61,NH60,NH64,NH65,NH67,NH69,NH63,NH68,SM112,SM116,SM117,SM118,SM115,SM111,SM113,SM114
done


### excluding ST and EG

for chr in tig00000004 tig00000025 tig00023313 tig00000069 tig00000092 tig00000104 tig00000123 tig00000112 tig00023367 tig00023308 tig00000175 tig00023325 tig00000191 tig00000156 tig00023380 tig00000166 tig00000178 tig00000165 tig00023422 tig00023431 tig00000185 tig00000224 tig00023309 tig00000280 tig00000243 tig00000334 tig00000406 tig00023455 tig00023334 tig00023437 tig00000348 tig00023543 tig00023450 tig00023331 tig00023368 tig00000410 tig00000430 tig00000479 tig00023498 tig00023302 tig00000575 tig00000555 tig00000579 tig00000590 tig00023461 tig00000532 tig00000570 tig00023535 tig00000691 tig00023572 tig00000659 tig00000714 tig00000604 tig00000609 tig00000683 tig00000626 tig00000759 tig00000647 tig00000787 tig00000906 tig00000693 tig00023349 tig00023328 tig00023419 tig00000819
do
	smc++ vcf2smc freebayes.SNPs.filtered.final.recode.vcf.gz out2/BOTH$chr.smc.gz $chr South:GF03,GF38,GF04,GF01,GF02,GF23,GF49,GF05,GF07,GF28,AR62,AR67,AR65,AR61,AR63,AR68,AR66,AR64 West:NH61,NH60,NH64,NH65,NH67,NH69,NH63,NH68,SM112,SM116,SM117,SM118,SM115,SM111,SM113,SM114
done


# within each population
for chr in tig00000004 tig00000025 tig00023313 tig00000069 tig00000092 tig00000104 tig00000123 tig00000112 tig00023367 tig00023308 tig00000175 tig00023325 tig00000191 tig00000156 tig00023380 tig00000166 tig00000178 tig00000165 tig00023422 tig00023431 tig00000185 tig00000224 tig00023309 tig00000280 tig00000243 tig00000334 tig00000406 tig00023455 tig00023334 tig00023437 tig00000348 tig00023543 tig00023450 tig00023331 tig00023368 tig00000410 tig00000430 tig00000479 tig00023498 tig00023302 tig00000575 tig00000555 tig00000579 tig00000590 tig00023461 tig00000532 tig00000570 tig00023535 tig00000691 tig00023572 tig00000659 tig00000714 tig00000604 tig00000609 tig00000683 tig00000626 tig00000759 tig00000647 tig00000787 tig00000906 tig00000693 tig00023349 tig00023328 tig00023419 tig00000819
do
	smc++ vcf2smc freebayes.SNPs.filtered.final.recode.vcf.gz out/South.$chr.smc.gz $chr South:GF03,GF38,GF04,GF01,GF02,GF23,GF49,GF05,GF07,GF28,AR62,AR67,AR65,AR61,AR63,AR68,AR66,AR64,TV70,TV67,TV66,TV65,TV69,TV74,TV73,TV68,EG25,EG26,EG21,EG27,EG24,EG22,EG28,EG23
	smc++ vcf2smc freebayes.SNPs.filtered.final.recode.vcf.gz out/West.$chr.smc.gz $chr West:ST48,ST46,ST44,ST42,ST41,ST45,ST47,ST43,NH61,NH60,NH64,NH65,NH67,NH69,NH63,NH68,SM112,SM116,SM117,SM118,SM115,SM111,SM113,SM114
done









## prepare input
~/software/smcpp/bin/smc++ vcf2smc freebayes.SNPs.filtered.final.recode.vcf.gz out/tig00000001.smc.gz tig00000001 South:TV70,TV67,TV66,TV65,TV69,TV74,TV73,TV68 West:SM:NH61,NH63,NH60,NH68,NH64,NH65,NH67,NH69,ST48,ST46

## do demographi inference
~/software/smcpp/bin/smc++ estimate --fold --t1 100 --tk 100000 -o analysis/ out/tig*.smc.gz

# plot
~/software/smcpp/bin/smc++ plot plot.pdf analysis/model.final.json

### contigs > 1 Mbp
tig00000001
tig00000004
tig00000025
tig00023313
tig00000069
tig00000092
tig00000104
tig00000123
tig00000112
tig00023367
tig00023308
tig00000175
tig00023325
tig00000191
tig00000156
tig00023380
tig00000166
tig00000178
tig00000165
tig00023422
tig00023431
tig00000185
tig00000224
tig00023309
tig00000280
tig00000243
tig00000334
tig00000406
tig00023455
tig00023334
tig00023437
tig00000348
tig00023543
tig00023450
tig00023331
tig00023368
tig00000410
tig00000430
tig00000479
tig00023498
tig00023302
tig00000575
tig00000555
tig00000579
tig00000590
tig00023461
tig00000532
tig00000570
tig00023535
tig00000691
tig00023572
tig00000659
tig00000714
tig00000604
tig00000609
tig00000683
tig00000626
tig00000759
tig00000647
tig00000787
tig00000906
tig00000693
tig00023349
tig00023328
tig00023419
tig00000819

